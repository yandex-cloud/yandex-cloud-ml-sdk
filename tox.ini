[tox]
envlist = py{3.9,3.10,3.11,3.12,3.13},py{3.9,3.10,3.11,3.12,3.13}-extra-deps,docs,ycmlsdk-compat

[testenv]
deps =
    -r test_requirements.txt

commands =
    pytest \
        --flakes \
        --doctest-modules \
        --doctest-ignore-import-errors \
        --block-network \
        tests \
        {posargs}

[testenv:py3.12]
commands =
    pytest \
        --flakes \
        --doctest-modules \
        --doctest-ignore-import-errors \
        --block-network \
        --pylint \
        tests \
        {posargs}


[testenv:ycmlsdk-compat]
basepython = python3.10
deps =
    .
    compat/yandex-cloud-ml-sdk
    -r test_requirements.txt
    -r test_requirements_extra.txt
commands =
    pytest \
        --block-network \
        --env numpy langchain_core pydantic pyarrow \
        --mypy \
        compat/yandex-cloud-ml-sdk \
        {posargs}

[testenv:py{3.9,3.10,3.11,3.12,3.13}-extra-deps]
deps =
    -r test_requirements.txt
    -r test_requirements_extra.txt

commands =
    pytest \
        --env numpy langchain_core pydantic pyarrow \
        --mypy \
        --flakes \
        --doctest-modules \
        --doctest-ignore-import-errors \
        --block-network \
        tests src examples \
        {posargs}

[testenv:docs]
basepython = python3.12
deps =
    -r docs/requirements.txt
commands =
    sphinx-build docs docs/_build -W {posargs}
